<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>VAN-Flow</title>

  <style>
    html { font-size: 150%; }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Helvetica Neue", Arial, sans-serif;
      line-height: 1.6;
      margin: 0;
      background: #ffffff;
      color: #111;
    }

    .hero { text-align: center; margin-top: 60px; margin-bottom: 10px; padding: 0 16px; }
    .hero h1 { font-size: 44px; margin-bottom: 10px; letter-spacing: -0.4px; }
    .brand { font-weight: 800; color: #FF2D8E; }

    .buttons { margin-top: 18px; }
    .buttons a {
      display: inline-block; padding: 10px 18px; margin: 6px;
      border-radius: 10px; border: 1px solid #ddd;
      text-decoration: none; color: #111; font-weight: 600; background: #fff;
    }
    .buttons a:hover { background: #f3f3f3; }

    .section-divider {
      width: 100%; height: 1px; background: #e8e8e8;
      margin: 70px 0 40px 0;
    }

    .fancy-title {
      text-align: center; font-size: 34px; font-weight: 800;
      margin: 80px 0 10px 0; letter-spacing: -0.5px; position: relative;
    }
    .fancy-title::after {
      content: ""; display: block; width: 80px; height: 5px;
      margin: 12px auto 0 auto; border-radius: 3px; background: #FF2D8E;
    }

    .highlight-box{
      margin: 40px auto 50px auto; max-width: 1200px;
      border-radius: 14px; padding: 18px 22px;
      background: rgba(255, 45, 142, 0.08);
      border: 1px solid rgba(255, 45, 142, 0.25);
      text-align: center; font-weight: 700; color: #111;
    }

    /* üé• VIDEO SECTION */
    .video-section { max-width: 1200px; margin: 0 auto 70px auto; padding: 0 20px; }

    .pair-header-row {
      display: grid;
      grid-template-columns: 1fr 60px 1fr;
      align-items: end;
      margin-bottom: 10px;
      text-align: center;
      font-weight: 800;
    }

    .video-grid {
      display: grid;
      grid-template-columns: 1fr 60px 1fr;
      align-items: start;
    }

    .pair-sep {
      display: flex; align-items: center; justify-content: center;
      color: #cfcfcf; font-weight: 800; font-size: 18px;
    }
    .pair-sep::before { content: "|"; }

    .video-card { text-align: center; }
    .video-card p { margin: 6px 0 8px 0; font-size: 14px; font-weight: 700; }
    .tag-proposed { color: #FF2D8E; }
    .tag-baseline { color: #444; }

    .video-frame {
      width: 100%;
      aspect-ratio: 16 / 9;   /* üëà ÏûêÏó∞Ïä§Îü¨Ïö¥ ÏòÅÏÉÅ ÎπÑÏú® */
      border-radius: 12px;
      border: 1px solid #eee;
      overflow: hidden;
      background: #000;
    }

    .video-frame video {
      width: 100%;
      height: 100%;
      object-fit: contain;    /* üëà ÏòÅÏÉÅ ÏûòÎ¶º Î∞©ÏßÄ */
      display: block;
      background: #000;
    }

    @media (max-width: 900px) {
      .video-grid { grid-template-columns: 1fr; gap: 18px; }
      .pair-sep { display: none; }
    }

    /* ABSTRACT BOX */
    .abstract-box {
      max-width: 1100px; margin: 0 auto 60px auto;
      padding: 32px 36px; border: 1px solid #e6e6e6;
      border-radius: 18px; box-shadow: 0 8px 24px rgba(0, 0, 0, 0.04);
      line-height: 1.75; font-size: 0.95rem;
    }
  </style>

  <script>
    window.MathJax = {
      tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] },
      svg: { fontCache: 'global' }
    };
  </script>
  <script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>
</head>

<body>

  <div class="hero">
    <h1>
      <span class="brand">VAN-Flow:</span>
      Variance-Averse $n$-Step Offline Reinforcement Learning <br>for Sparse Long-Horizon Environments
    </h1>
    <p><em>ICML 2026</em></p>

    <div class="buttons">
      <a href="paper.pdf">üìÑ Paper</a>
      <a href="https://github.com/your-repo">üíª Code</a>
    </div>
  </div>

  <div class="highlight-box">
    The $n$-step return with a <span style="color:#FF2D8E;font-weight:900;">variance-averse expectation</span>
    effectively addresses long-horizon sparse-reward challenges in offline RL.
  </div>

  <!-- üé• QUALITATIVE RESULTS -->
  <div class="video-section">

    <div class="pair-header-row">
      <div>Baseline</div>
      <div></div>
      <div>VAN-Flow (Ours)</div>
    </div>

    <div class="video-grid">

      <!-- Baseline -->
      <div class="video-card">
        <p class="tag-baseline">FQL-n</p>
        <div class="video-frame">
          <video autoplay loop muted playsinline preload="metadata">
            <source src="assets/video/ant_teleport.mp4" type="video/mp4">
          </video>
        </div>
      </div>

      <div class="pair-sep"></div>

      <!-- Ours -->
      <div class="video-card">
        <p class="tag-proposed">VAN-Flow</p>
        <div class="video-frame">
          <video autoplay loop muted playsinline preload="metadata">
            <source src="assets/video/puzzle_3x3.mp4" type="video/mp4">
          </video>
        </div>
      </div>

    </div>
  </div>
  
  <div class="section-divider"></div>
  <h2 class="fancy-title">Abstract</h2>

  <!-- üßæ ABSTRACT IN GRAY BOX -->
  <div class="abstract-box">
    Offline reinforcement learning (RL) in sparse, long-horizon environments is challenging because 
    value estimation errors compound over long backup horizons, and offline datasets often provide 
    limited coverage. While $n$-step returns mitigate long-horizon bias, they also amplify 
    return variance, which can destabilize offline learning under heterogeneous behavior data. 
    We show that this variance amplification constitutes a primary failure mode of na√Øvely applying 
    long-horizon return targets in offline RL. 
    To address this challenge, we propose 
    <b style="color:#FF2D8E;">VAN-Flow</b>, 
    a variance-averse offline RL framework that couples $n$-step learning with 
    categorical distributional value estimation. 
    VAN-Flow introduces a variance-averse expectation that downweights unreliable high-variance return targets, 
    together with a $Q$-guided flow-matching policy and rejection sampling to mitigate out-of-distribution actions. 
    Notably, VAN-Flow shows remarkable improvements on challenging datasets with heterogeneous behavior data.
  </div>

  <div class="section-divider"></div>
  <h2 class="fancy-title">Variance-Averse Expectation</h2>
  
  <div class="two-col">
    <!-- LEFT CARD -->
    <div class="card">
      <div class="card-img">
        <img src="assets/image/why_variance_averse.png" alt="Why variance-averse is needed">
      </div>
      <div class="card-body">
        <div class="card-title">Why Variance-Averse is Needed?</div>
  
        <!-- Ïó¨Í∏∞Ïóê ÏôºÏ™Ω ÏÑ§Î™Ö ÌÖçÏä§Ìä∏ ÎÑ£ÏúºÎ©¥ Îê® -->
        <p style="margin:0;color:#333;">
          Long-horizon decision-making under sparse rewards is challenging because informative feedback is delayed and
          rarely observed, making value estimation susceptible to error propagation. This becomes more severe in offline RL
          due to limited dataset coverage and heterogeneous behavior policies.
        </p>
      </div>
    </div>
  
    <!-- RIGHT CARD -->
    <div class="card">
      <div class="card-img">
        <img src="assets/image/VaE.png" alt="Variance-averse expectation">
      </div>
      <div class="card-body">
        <div class="card-title">Variance-Averse Expectation</div>
  
        <!-- Ïó¨Í∏∞Ïóê Ïò§Î•∏Ï™Ω ÏÑ§Î™Ö ÌÖçÏä§Ìä∏ ÎÑ£ÏúºÎ©¥ Îê® -->
        <p style="margin:0;color:#333;">
          VAN-Flow introduces a variance-averse expectation that downweights unreliable high-variance $n$-step return targets
          using a categorical distributional critic, preserving bias-reduction benefits while preventing variance-induced
          instability.
        </p>
      </div>
    </div>
  </div>

      <!-- ===== VAN-FLOW METHOD (your screenshot style) ===== -->
      <div class="section-divider"></div>
      <h2 class="fancy-title"><b style="color:#FF2D8E;">VAN-Flow</b>: Categorical Critic & Flow-based Actor</h2>
    
      <!-- Block 1 -->
      <div class="method-wrap">
        <div class="method-title"><span class="accent">Categorical</span> Critic</div>
    
        <div class="method-panel">
          <div class="method-row">
    
            <div class="method-left">
              <div class="img-box">
                <img src="assets/image/categorical_critic.png" alt="Categorical critic image">
              </div>
    
              <div class="text-box">
                <div class="h">Categorical Distributional Critic</div>
                <p>
                  VAN-Flow represents the $n$-step return target as a categorical distribution and applies a
                  variance-averse expectation to stabilize value learning under heterogeneous offline data.
                </p>
              </div>
            </div>
    
            <div class="method-right">
              <video autoplay loop muted playsinline preload="metadata">
                <!-- TODO: replace with your critic video -->
                <source src="assets/video/critic_demo.mp4" type="video/mp4">
              </video>
            </div>
    
          </div>
        </div>
      </div>
    
      <!-- Block 2 -->
      <div class="method-wrap">
        <div class="method-title"><span class="accent">Flow-based</span> Actor</div>
    
        <div class="method-panel">
          <div class="method-row">
    
            <div class="method-left">
              <div class="img-box">
                <img src="assets/image/flow_matching.png" alt="Flow actor image">
              </div>
    
              <div class="text-box">
                <div class="h">Flow-based Actor</div>
                <p>
                  The actor is trained via flow matching guided by the critic, aligning action generation
                  with high-value regions and improving robustness in offline RL.
                </p>
              </div>
            </div>
    
            <div class="method-right">
              <video autoplay loop muted playsinline preload="metadata">
                <!-- TODO: replace with your actor video -->
                <source src="assets/video/actor_demo.mp4" type="video/mp4">
              </video>
            </div>
          </div>
        </div>
      </div>

    <!-- ===== Simulation Results ===== -->
  <div class="section-divider"></div>
  <h2 class="fancy-title">Simulation Results</h2>

  <!-- Q1 -->
  <div class="qa">
    <span class="qtag">[<b>Q1.</b>]</span>
    Does the <span class="magenta">variance-averse expectation</span> enhance RL performance in sparse-reward and long-horizon environments?
  </div>
  <div class="result-card">
    <div class="table-frame">
      <!-- ‚úÖ Put your rendered table image here -->
      <img src="assets/image/table_antmaze_results.PNG" alt="AntMaze results table">
      <div class="table-caption">
        <b>Offline performance on AntMaze tasks.</b> Scores are normalized following the D4RL protocol.
        Entries marked ‚Äú--‚Äù indicate results not reported in prior work.
      </div>
    </div>
  </div>

  <!-- Q2 -->
  <div class="qa">
    <span class="qtag">[<b>Q2.</b>]</span>
    Does the proposed solution outperform existing <b><i>flow-based policies</i></b>?
  </div>
  <div class="result-card">
    <div class="table-frame">
      <img src="assets/image/table_ogbench_results.PNG" alt="OGBench results table">
      <div class="table-caption">
        <b>Performance comparison in OGBench.</b> Task-wise scores across Gaussian-based and Flow-based baselines.
      </div>
    </div>
  </div>

  <!-- Q3 -->
  <div class="qa">
    <span class="qtag">[<b>Q3.</b>]</span>
    Does <b style="color:#FF2D8E;">VAN-Flow</b> have strong generalization ability in off-to-online adaptation?
  </div>
  <div class="result-card">
    <div class="table-frame">
      <img src="assets/image/table_off2on_results.PNG" alt="Offline-to-online results table">
      <div class="table-caption">
        <b>Offline-to-online fine-tuning performance.</b> Gray indicates offline performance before fine-tuning and bold indicates after fine-tuning.
      </div>
    </div>
  </div>

        </div>
      </div>
    
    </div>

  
</body>
</html>
