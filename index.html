<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>VAN-Flow</title>

  <style>
    html { font-size: 150%; }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Helvetica Neue", Arial, sans-serif;
      line-height: 1.6;
      margin: 0;
      background: #ffffff;
      color: #111;
    }

    .hero {
      text-align: center;
      margin-top: 60px;
      margin-bottom: 10px;
      padding: 0 16px;
    }

    .hero h1 {
      font-size: 44px;
      margin-bottom: 10px;
      letter-spacing: -0.4px;
    }

    .brand { font-weight: 800; color: #FF2D8E; }

    .buttons { margin-top: 18px; }

    .buttons a {
      display: inline-block;
      padding: 10px 18px;
      margin: 6px;
      border-radius: 10px;
      border: 1px solid #ddd;
      text-decoration: none;
      color: #111;
      font-weight: 600;
      background: #fff;
    }

    .buttons a:hover { background: #f3f3f3; }

    .section,
    .video-section {
      max-width: 1300px;
      margin: 0 auto 70px auto;
      padding: 0 20px;
    }

    .fancy-title {
      text-align: center;
      font-size: 34px;
      font-weight: 800;
      margin: 80px 0 10px 0;
      letter-spacing: -0.5px;
      position: relative;
    }
    
    .fancy-title::after {
      content: "";
      display: block;
      width: 80px;
      height: 5px;
      margin: 12px auto 0 auto;
      border-radius: 3px;
      background: #FF2D8E;
    }

    /* üî• Highlight Box (Moved Up) */
    .highlight-box{
      margin: 40px auto 50px auto;
      max-width: 1200px;
      border-radius: 14px;
      padding: 18px 22px;
      background: rgba(255, 45, 142, 0.08);
      border: 1px solid rgba(255, 45, 142, 0.25);
      text-align: center;
      font-weight: 700;
      color: #111;
    }

    .highlight-box .emph{
      color: #FF2D8E;
      font-weight: 900;
    }

    /* üßæ Abstract Gray Box */
    .abstract-box {
      max-width: 1100px;
      margin: 0 auto 60px auto;
      padding: 32px 36px;
      background: #ffffff;
      border: 1px solid #e6e6e6;
      border-radius: 18px;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.04);
      line-height: 1.75;
      font-size: 0.95rem;
    }

    .intro-lead{
      text-align: center;
      font-size: 16px;
      color: #444;
      max-width: 900px;
      margin: 0 auto 60px auto;
      padding: 0 20px;
    }

    .pair-header-row {
      display: grid;
      grid-template-columns: 1fr 1fr 78px 1fr 1fr;
      align-items: end;
      margin-bottom: 10px;
    }

    .pair-title {
      grid-column: span 2;
      text-align: center;
      font-weight: 800;
      font-size: 16px;
    }

    .mid-gap { width: 100%; }

    .video-grid {
      display: grid;
      grid-template-columns: 1fr 22px 1fr 78px 1fr 22px 1fr;
      align-items: start;
    }

    .pair-sep {
      display: flex;
      align-items: center;
      justify-content: center;
      color: #cfcfcf;
      font-weight: 800;
      font-size: 18px;
    }

    .pair-sep::before { content: "|"; }

    .video-card { text-align: center; }

    .video-card p {
      margin: 6px 0 8px 0;
      font-size: 14px;
      font-weight: 700;
    }

    .tag-proposed { color: #FF2D8E; }
    .tag-baseline { color: #444; }

    .video-frame {
      width: 100%;
      aspect-ratio: 1 / 1;
      border-radius: 12px;
      border: 1px solid #eee;
      overflow: hidden;
      background: #000;
    }

    .video-frame video {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }

    .section-divider {
      width: 100%;
      height: 1px;
      background: #e8e8e8;
      margin: 70px 0 40px 0;
    }

    @media (max-width: 1000px) {
      .pair-header-row { grid-template-columns: 1fr; gap: 8px; }
      .pair-title { grid-column: auto; }
      .mid-gap, .pair-sep { display: none; }
      .video-grid { grid-template-columns: 1fr; gap: 18px; }
      .hero h1 { font-size: 34px; }
    }
    .two-col {
      max-width: 1300px;
      margin: 0 auto 70px auto;
      padding: 0 20px;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 22px;
    }
    
    .card {
      background: #fff;
      border: 1px solid #e6e6e6;
      border-radius: 18px;
      box-shadow: 0 8px 24px rgba(0,0,0,0.04);
      overflow: hidden;
    }
    
    .card-img {
      width: 100%;
      aspect-ratio: 16 / 9;
      background: #f6f6f6;
      border-bottom: 1px solid #eeeeee;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 10px;              /* Ïó¨Î∞± Ï∂îÍ∞Ä (ÏÑ†ÌÉù) */
    }
    
    .card-img img {
      max-width: 100%;
      max-height: 100%;
      width: auto;
      height: auto;
      object-fit: contain;        /* ‚úÖ Ïù¥ÎØ∏ÏßÄ Ï†ÑÏ≤¥ Î≥¥Ïù¥ÎèÑÎ°ù */
    }
    .card-body {
      padding: 20px 22px 22px 22px;
    }
    
    .card-title {
      margin: 0 0 10px 0;
      font-size: 22px;
      font-weight: 900;
      letter-spacing: -0.2px;
    }
    
    @media (max-width: 1000px) {
      .two-col { grid-template-columns: 1fr; }
      .card-img { aspect-ratio: 4 / 3; }
    }

    .method-stack {
      max-width: 1300px;
      margin: 0 auto 80px auto;
      padding: 0 20px;
      display: flex;
      flex-direction: column;
      gap: 28px;
    }
    
    /* Method Ï†ÑÏö© Ïπ¥Îìú Ïù¥ÎØ∏ÏßÄÎäî ÌååÏù¥ÌîÑÎùºÏù∏ ÎäêÎÇåÏúºÎ°ú ÏôÄÏù¥ÎìúÌïòÍ≤å */
    .method-stack .card-img {
      aspect-ratio: 21 / 9;
    }
    
    @media (max-width: 1000px) {
      .method-stack .card-img {
        aspect-ratio: 16 / 9;
      }
    }
  </style>

  <script>
    window.MathJax = {
      tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] },
      svg: { fontCache: 'global' }
    };
  </script>
  <script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>
</head>

<body>

  <div class="hero">
    <h1>
      <span class="brand">VAN-Flow:</span>
      Variance-Averse $n$-Step Offline Reinforcement Learning <br>for Sparse Long-Horizon Environments
    </h1>
    <p><em>ICML 2026</em></p>

    <div class="buttons">
      <a href="paper.pdf">üìÑ Paper</a>
      <a href="https://github.com/your-repo">üíª Code</a>
    </div>
  </div>

  <!-- üí° MOVED HIGHLIGHT BOX HERE -->
  <div class="highlight-box">
    The $n$-step return with a <span class="emph">variance-averse expectation</span> effectively addresses the challenges of long-horizon, sparse-reward environments in offline RL.
  </div>

  <!-- üé• QUALITATIVE RESULTS -->
  <div class="video-section">
    <div class="pair-header-row">
      <div class="pair-title">AntMaze-Play</div>
      <div class="mid-gap"></div>
      <div class="pair-title">AntMaze-Explore</div>
    </div>

    <div class="video-grid">
      <div class="video-card">
        <p class="tag-baseline">FQL-n</p>
        <div class="video-frame">
          <video autoplay loop muted playsinline preload="metadata">
            <source src="assets/video/antmaze_large_play_fql.mp4" type="video/mp4">
          </video>
        </div>
      </div>

      <div class="pair-sep"></div>

      <div class="video-card">
        <p class="tag-proposed">VAN-Flow (Ours)</p>
        <div class="video-frame">
          <video autoplay loop muted playsinline preload="metadata">
            <source src="assets/video/antmaze_large_play_vanflow.mp4" type="video/mp4">
          </video>
        </div>
      </div>

      <div class="mid-gap"></div>

      <div class="video-card">
        <p class="tag-baseline">FQL-n</p>
        <div class="video-frame">
          <video autoplay loop muted playsinline preload="metadata">
            <source src="assets/video/antmaze_explore_fql.mp4" type="video/mp4">
          </video>
        </div>
      </div>

      <div class="pair-sep"></div>

      <div class="video-card">
        <p class="tag-proposed">VAN-Flow (Ours)</p>
        <div class="video-frame">
          <video autoplay loop muted playsinline preload="metadata">
            <source src="assets/video/antmaze_explore_vanflow.mp4" type="video/mp4">
          </video>
        </div>
      </div>
    </div>
  </div>

  <div class="section-divider"></div>
  <h2 class="fancy-title">Abstract</h2>

  <!-- üßæ ABSTRACT IN GRAY BOX -->
  <div class="abstract-box">
    Offline reinforcement learning (RL) in sparse, long-horizon environments is challenging because 
    value estimation errors compound over long backup horizons, and offline datasets often provide 
    limited coverage. While $n$-step returns mitigate long-horizon bias, they also amplify 
    return variance, which can destabilize offline learning under heterogeneous behavior data. 
    We show that this variance amplification constitutes a primary failure mode of na√Øvely applying 
    long-horizon return targets in offline RL. 
    To address this challenge, we propose 
    <b style="color:#FF2D8E;">VAN-Flow</b>, 
    a variance-averse offline RL framework that couples $n$-step learning with 
    categorical distributional value estimation. 
    VAN-Flow introduces a variance-averse expectation that downweights unreliable high-variance return targets, 
    together with a $Q$-guided flow-matching policy and rejection sampling to mitigate out-of-distribution actions. 
    Notably, VAN-Flow shows remarkable improvements on challenging datasets with heterogeneous behavior data.
  </div>

  <div class="section-divider"></div>
  <h2 class="fancy-title">Variance-Averse Expectation</h2>
  
  <div class="two-col">
    <!-- LEFT CARD -->
    <div class="card">
      <div class="card-img">
        <img src="assets/image/why_variance_averse.png" alt="Why variance-averse is needed">
      </div>
      <div class="card-body">
        <div class="card-title">Why Variance-Averse is Needed?</div>
  
        <!-- Ïó¨Í∏∞Ïóê ÏôºÏ™Ω ÏÑ§Î™Ö ÌÖçÏä§Ìä∏ ÎÑ£ÏúºÎ©¥ Îê® -->
        <p style="margin:0;color:#333;">
          Long-horizon decision-making under sparse rewards is challenging because informative feedback is delayed and
          rarely observed, making value estimation susceptible to error propagation. This becomes more severe in offline RL
          due to limited dataset coverage and heterogeneous behavior policies.
        </p>
      </div>
    </div>
  
    <!-- RIGHT CARD -->
    <div class="card">
      <div class="card-img">
        <img src="assets/image/VaE.png" alt="Variance-averse expectation">
      </div>
      <div class="card-body">
        <div class="card-title">Variance-Averse Expectation</div>
  
        <!-- Ïó¨Í∏∞Ïóê Ïò§Î•∏Ï™Ω ÏÑ§Î™Ö ÌÖçÏä§Ìä∏ ÎÑ£ÏúºÎ©¥ Îê® -->
        <p style="margin:0;color:#333;">
          VAN-Flow introduces a variance-averse expectation that downweights unreliable high-variance $n$-step return targets
          using a categorical distributional critic, preserving bias-reduction benefits while preventing variance-induced
          instability.
        </p>
      </div>
    </div>
  </div>

    <!-- VAN-FLOW METHOD -->
    <div class="section-divider"></div>
    <h2 class="fancy-title">
      <b style="color:#FF2D8E;">VAN-Flow</b>: Variance-Averse $n$-Step Return with Flow-Matching
    </h2>
    
    <div class="method-stack">
    
      <!-- üî∑ Block 1: Categorical Critic -->
      <div class="card">
        <div class="card-img">
          <img src="assets/image/categorical_critic.png" alt="Categorical critic">
        </div>
        <div class="card-body">
          <div class="card-title">Categorical Distributional Critic</div>
          <p style="margin:0;color:#333;">
            VAN-Flow models the $n$-step return target as a categorical distribution and applies a
            variance-averse expectation to downweight unreliable high-variance targets. This enables
            uncertainty-aware value estimation and stabilizes multi-step learning under heterogeneous
            offline datasets.
          </p>
        </div>
      </div>
    
      <!-- üî∑ Block 2: Flow-Matching Policy -->
      <div class="card">
        <div class="card-img">
          <img src="assets/image/flow_matching.png" alt="Flow matching policy">
        </div>
        <div class="card-body">
          <div class="card-title">Q-Guided Flow-Matching Policy</div>
          <p style="margin:0;color:#333;">
            The policy is trained via Q-guided flow matching, aligning action generation with high-value
            regions of the learned return distribution. This enables stable generative policy learning
            while leveraging the critic‚Äôs uncertainty-aware guidance.
          </p>
        </div>
      </div>
    
      <!-- üî∑ Block 3: Rejection / OOD Control -->
      <div class="card">
        <div class="card-img">
          <img src="assets/image/rejection_sampling.png" alt="Rejection sampling">
        </div>
        <div class="card-body">
          <div class="card-title">Rejection Sampling for Offline Robustness</div>
          <p style="margin:0;color:#333;">
            Rejection sampling filters out out-of-distribution actions during policy deployment,
            preventing value extrapolation errors and improving robustness in purely offline settings.
          </p>
        </div>
      </div>
    
    </div>


  
</body>
</html>
